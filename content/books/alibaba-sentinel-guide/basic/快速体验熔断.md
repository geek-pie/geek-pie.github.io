---
title: "快速体验熔断"
weight: 2
---

https://bbs.huaweicloud.com/blogs/327075


# 对内部服务进行熔断


https://sentinelguard.io/zh-cn/docs/circuit-breaking.html


* fallback：fallback函数名称，可选项，用于在抛出异常的时候提供fallback 处理逻辑。注意所有的异常都会走到这里面。







https://cloud.tencent.com/developer/article/2199106




# OkHttp下的熔断
https://sentinelguard.io/zh-cn/docs/open-source-framework-integrations.html

OkHttp 2.x非常过时
```xml
   <dependency>
            <groupId>com.squareup.okhttp3</groupId>
            <artifactId>okhttp</artifactId>
            <version>${okhttp-version}</version>
        </dependency>
        <dependency>
            <groupId>com.squareup.okhttp3</groupId>
            <artifactId>logging-interceptor</artifactId>
            <version>${okhttp-version}</version>
        </dependency>
```
因为某些实际的原因，使用的是2.7.5版本
```
 <okhttp-version>3.14.9</okhttp-version>
```


```java
public class SentinelOkHttpConfig {

    public static final String DEFAULT_RESOURCE_PREFIX = "okhttp:";

    private final String resourcePrefix;
    private final OkHttpResourceExtractor resourceExtractor;
    private final OkHttpFallback fallback;

    public SentinelOkHttpConfig() {
        this(DEFAULT_RESOURCE_PREFIX);
    }

    public SentinelOkHttpConfig(String resourcePrefix) {
        this(resourcePrefix, new DefaultOkHttpResourceExtractor(), new DefaultOkHttpFallback());
    }

    public SentinelOkHttpConfig(OkHttpResourceExtractor resourceExtractor, OkHttpFallback fallback) {
        this(DEFAULT_RESOURCE_PREFIX, resourceExtractor, fallback);
    }

    public SentinelOkHttpConfig(String resourcePrefix,
                                OkHttpResourceExtractor resourceExtractor,
                                OkHttpFallback fallback) {
        AssertUtil.notNull(resourceExtractor, "resourceExtractor cannot be null");
        AssertUtil.notNull(fallback, "fallback cannot be null");
        this.resourcePrefix = resourcePrefix;
        this.resourceExtractor = resourceExtractor;
        this.fallback = fallback;
    }

    public String getResourcePrefix() {
        return resourcePrefix;
    }

    public OkHttpResourceExtractor getResourceExtractor() {
        return resourceExtractor;
    }

    public OkHttpFallback getFallback() {
        return fallback;
    }

    @Override
    public String toString() {
        return "SentinelOkHttpConfig{" +
            "resourcePrefix='" + resourcePrefix + '\'' +
            ", resourceExtractor=" + resourceExtractor +
            ", fallback=" + fallback +
            '}';
    }
}
```

默认只会拦截